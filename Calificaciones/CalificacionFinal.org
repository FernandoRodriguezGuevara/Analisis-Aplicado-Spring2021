* Calificaciones Examen Final
#+name: calificaciones
|--------+------+------+------+------+-------|
|   C.U. | P1.1 | P1.2 | P2.1 | P2.2 | Final |
|--------+------+------+------+------+-------|
| 131008 |   20 |   20 |   20 |   35 |    95 |
| 151135 |   20 |   20 |    0 |    0 |    40 |
| 151767 |   20 |   20 |   10 |   10 |    60 |
| 152808 |   20 |   20 |    5 |    5 |    50 |
| 157045 |   20 |   20 |   10 |   15 |    65 |
| 163029 |   20 |   20 |   20 |   30 |    90 |
| 165815 |   20 |   20 |   10 |   15 |    65 |
| 165860 |   20 |   20 |   20 |    0 |    60 |
| 166088 |   20 |   20 |   20 |   15 |    75 |
| 166780 |   20 |   20 |   15 |   20 |    75 |
| 170309 |   20 |   20 |   20 |   30 |    90 |
| 170454 |   20 |   20 |   20 |   35 |    95 |
| 171786 |   20 |   20 |   10 |   15 |    65 |
| 171886 |   20 |   20 |   20 |   15 |    75 |
| 172255 |   20 |   20 |   20 |    5 |    65 |
| 173122 |   20 |   10 |   20 |   35 |    85 |
| 173144 |   20 |   20 |   10 |    0 |    50 |
| 173993 |   20 |   20 |   20 |   15 |    75 |
| 174052 |   20 |   20 |   15 |   30 |    85 |
| 174064 |   20 |   20 |   20 |   30 |    90 |
| 174139 |   20 |   20 |   20 |   15 |    75 |
| 174308 |   20 |   20 |   20 |   15 |    75 |
| 175311 |   20 |   20 |   20 |   25 |    85 |
| 175551 |   20 |   20 |   15 |   15 |    70 |
| 176357 |   20 |   20 |   10 |   15 |    65 |
| 181158 |   20 |   20 |   20 |   15 |    75 |
| 164181 |   20 |   20 |   10 |   35 |    85 |
#+TBLFM: $6=vmin(vsum($2..$5), 100)

#+name: calificaciones-csv
#+BEGIN_SRC elisp :var x=calificaciones :wrap example :file ExamenFinal.csv :results file
(orgtbl-to-csv x nil)
#+END_SRC

#+RESULTS: calificaciones-csv
#+begin_example
[[file:ExamenFinal.csv]]
#+end_example

#+begin_src R :session
  library(tidyverse)
  library(knitr)
  EF  <- read_csv('ExamenFinal.csv')
  Proy  <- read_csv('proyecto.csv')
  EP <-read_csv('parcial.csv')

  data <- left_join(EF,EP, by='C.U.', suffix=c('_EF', '_EP')) %>%
    left_join(Proy, by='C.U.') %>%
    select('C.U.',starts_with('Final')) %>%
    mutate(CalificacionFinal=Final_EF*0.4+Final_EP*0.3+Final*0.3) %>%
    rename(Examen_Parcial=Final_EP,Examen_Final=Final_EP, Proyecto_Final=Final)
#+end_src

#+begin_src R :session :results
kable(data)
#+end_src


|   C.U. | Final_EF | Examen_Final | Proyecto_Final | CalificacionFinal |
|--------+----------+--------------+----------------+-------------------|
| 131008 |       95 |          100 |             90 |              95.0 |
| 151135 |       40 |           35 |             81 |              50.8 |
| 151767 |       60 |           85 |             72 |              71.1 |
| 152808 |       50 |           70 |             64 |              60.2 |
| 157045 |       65 |           65 |             90 |              72.5 |
| 163029 |       90 |          100 |             80 |              90.0 |
| 165815 |       65 |           35 |             81 |              60.8 |
| 165860 |       60 |           50 |            100 |              69.0 |
| 166088 |       75 |           55 |            100 |              76.5 |
| 166780 |       75 |          100 |             80 |              84.0 |
| 170309 |       90 |           85 |            100 |              91.5 |
| 170454 |       95 |           90 |             81 |              89.3 |
| 171786 |       65 |           85 |             90 |              78.5 |
| 171886 |       75 |          100 |            100 |              90.0 |
| 172255 |       65 |          100 |             90 |              83.0 |
| 173122 |       85 |           70 |             90 |              82.0 |
| 173144 |       50 |           65 |            100 |              69.5 |
| 173993 |       75 |           85 |            100 |              85.5 |
| 174052 |       85 |           70 |             90 |              82.0 |
| 174064 |       90 |           80 |            100 |              90.0 |
| 174139 |       75 |           80 |             72 |              75.6 |
| 174308 |       75 |          100 |            100 |              90.0 |
| 175311 |       85 |          100 |             81 |              88.3 |
| 175551 |       70 |           60 |            100 |              76.0 |
| 176357 |       65 |           40 |             90 |              65.0 |
| 181158 |       75 |          100 |            100 |              90.0 |
| 164181 |       85 |           80 |             90 |              85.0 |

#+begin_src R  :session  :file Final.png :results graphics file
  data %>%
      select(Final) %>%
      ggplot(aes(Final))+
      geom_histogram(bins=5)
#+end_src

#+RESULTS:
[[file:Final.png]]

[[file:./Final.png]]

#+begin_src R  :session  :file p2.1.png :results graphics file
data %>%
    select(P2.1) %>%
    ggplot(aes(P2.1))+
    geom_histogram(bins=10)
#+end_src

#+RESULTS:
[[file:p2.1.png]]

[[file:p2.1.png]]

#+begin_src R  :session  :file p2.2.png :results graphics file
data %>%
    select(P2.2) %>%
    ggplot(aes(P2.2))+
    geom_histogram(bins=10)

#+end_src

#+RESULTS:
[[file:p2.2.png]]

[[file:density.png]]
